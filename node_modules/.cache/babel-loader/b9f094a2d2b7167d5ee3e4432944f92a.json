{"ast":null,"code":"// Add your JavaScript code here\nconst MAX_WIDTH = Math.max(1080, window.innerWidth);\nconst MAX_HEIGHT = 720;\nconst margin = {\n  top: 40,\n  right: 100,\n  bottom: 40,\n  left: 175\n}; // Assumes the same graph width, height dimensions as the example dashboard. Feel free to change these if you'd like\n\nlet graph_1_width = MAX_WIDTH / 2 - 10,\n    graph_1_height = 250;\nlet graph_2_width = MAX_WIDTH / 2 - 10,\n    graph_2_height = 275;\nlet graph_3_width = MAX_WIDTH / 2,\n    graph_3_height = 575;\nFOOTBALL_DATA_SET = \"/football.csv\";\n\nfunction graph1() {\n  let svg = d3.select(\"#graph1\").append(\"svg\").attr(\"width\", graph_1_width).attr(\"height\", graph_1_height).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n  let h = graph_1_height - margin.top - margin.bottom;\n  let countG = svg.append(\"g\");\n  var y_axis_label = svg.append(\"g\").attr(\"transform\", \"translate(0,\" + h + \")\");\n  let title = svg.append(\"text\").text(\"Number of Games Played by Year\").attr(\"transform\", `translate(${(graph_1_width - margin.left - margin.right) / 2}, ${-25})`).style(\"text-anchor\", \"middle\").style(\"font-size\", \"14\");\n  svg.append(\"text\").attr(\"transform\", `translate(${(graph_1_width - margin.left - margin.right) / 2},\n                                                ${graph_1_height - margin.top - margin.bottom + 40})`).style(\"text-anchor\", \"middle\").text(\"Year\").attr(\"font-size\", \"14\");\n  svg.append(\"text\").attr(\"transform\", `translate(-50, ${(graph_1_height - margin.top - margin.bottom) / 2})`).style(\"text-anchor\", \"middle\").text(\"Count\").attr(\"font-size\", \"14\");\n  groups = [2020, 2010, 2000, 1990, 1980, 1970, 1960, 1950, 1940, 1930, 1920, 1910, 1900];\n  d3.select(\"#selectButton\").selectAll('year').data(groups).enter().append('option').text(function (d) {\n    return d;\n  }).attr(\"value\", function (d) {\n    return d;\n  });\n  d3.select(\"#selectButton\").on(\"change\", function (d) {\n    var selectedOption = d3.select(this).property(\"value\");\n    filterData(selectedOption);\n  });\n\n  function filterData(option) {\n    let filename = FOOTBALL_DATA_SET;\n    d3.csv(filename).then(function (data) {\n      data = getData(data, function (entry) {\n        let dif = option - parseInt(entry.date.slice(0, 4));\n\n        if (dif >= 0 && dif < 10) {\n          return true;\n        }\n\n        return false;\n      });\n      data = countGamesInYear(data);\n      data = sortData(data, function (a, b) {\n        return b - a;\n      });\n      let y = d3.scaleLinear().domain([0, d3.max(data, d => d[1])]).range([graph_1_height - margin.top - margin.bottom, 0]);\n      let x = d3.scaleBand().domain(data.map(d => d[0])).range([0, graph_1_width - margin.left - margin.right]).padding(0.1);\n      y_axis_label.call(d3.axisBottom(x).tickPadding(5)); // let color = d3.scaleOrdinal()\n      //     .range(d3.schemeAccent);\n\n      let bars = svg.selectAll(\"rect\").data(data);\n      bars.enter().append(\"rect\").merge(bars).transition().duration(1000).attr(\"fill\", \"#59C3C3\").attr(\"x\", function (d) {\n        return x(d[0]);\n      }).attr(\"y\", d => y(d[1])).attr(\"width\", x.bandwidth()).attr(\"height\", function (d) {\n        return graph_1_height - margin.top - margin.bottom - y(d[1]);\n      });\n      let counts = countG.selectAll(\"text\").data(data);\n      counts.enter().append(\"text\").merge(counts).transition().duration(1000).attr(\"y\", function (d) {\n        return y(d[1]) - 5;\n      }).attr(\"x\", function (d) {\n        return x(d[0]) + 0.35 * x.bandwidth();\n      }).style(\"text-anchor\", \"start\").text(function (d) {\n        return d[1];\n      }).attr(\"font-size\", \"12\");\n      bars.exit().remove();\n      counts.exit().remove();\n\n      function getData(data, comparator) {\n        return data.filter(comparator);\n      }\n\n      function sortData(data, comparator) {\n        let new_data = Object.keys(data);\n        return new_data.sort(comparator).slice(0, 10).map(key => [key, data[key]]);\n      }\n\n      function countGamesInYear(data) {\n        var countData = {};\n\n        for (var i = 0; i < data.length; i++) {\n          let year = parseInt(data[i].date.slice(0, 4));\n\n          if (!(year in countData)) {\n            countData[year] = 1;\n          } else {\n            countData[year]++;\n          }\n        }\n\n        return countData;\n      }\n    });\n  }\n\n  filterData(2020);\n}\n\nfunction graph3() {\n  var location = {\n    \"Asturias\": [43.36, -5.95],\n    \"Jersey\": [49.21, -2.13],\n    \"Chameria\": [46.46, 5.56],\n    \"Menorca\": [39.94, 4.11],\n    \"Canary Islands\": [28.29, -16.62],\n    \"Padania\": [45.29, 11.16],\n    \"Basque Country\": [42.96, -2.59],\n    \"Brazil\": [-23.53, -46.62],\n    \"Tahiti\": [-17.36, -149.5],\n    \"Ivory Coast\": [5.34, -4.02],\n    \"Iraqi Kurdistan\": [30.86, 44.10],\n    \"Ynys MÃ´n\": [53.267684, -4.371611],\n    \"Isle of Man\": [54.205801, -4.529593],\n    \"Abkhazia\": [43.141859, 40.999746],\n    \"Guernsey\": [49.446756, -2.573537],\n    \"Yugoslavia\": [44.810045, 20.429455],\n    \"Isle of Wight\": [50.682774, -1.318987],\n    \"Scotland\": [57.087281, -2.908522],\n    \"China PR\": [32.137429, 103.543756],\n    \"German DR\": [52.555621, 13.382851]\n  };\n  let svg = d3.select(\"#graph3\").append(\"svg\").attr(\"width\", graph_3_width).attr(\"height\", graph_3_height).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n  var projection = d3.geoMercator().center([0, 20]) // GPS of location to zoom on\n  .scale(99) // This is like the zoom\n  .translate([(graph_3_width - margin.left - margin.right) / 2, (graph_3_height - margin.top - margin.bottom) / 2]);\n  var curr_nations = 10;\n  var curr_games = 20;\n  groups = [10, 20, 30, 40];\n  d3.select(\"#selectButton2\").selectAll('number').data(groups).enter().append('option').text(function (d) {\n    return d;\n  }) // text showed in the menu\n  .attr(\"value\", function (d) {\n    return d;\n  }); // corresponding value returned by the button\n\n  d3.select(\"#selectButton2\").on(\"change\", function (d) {\n    // recover the option that has been chosen\n    var selectedOption = d3.select(this).property(\"value\");\n    curr_nations = selectedOption; // run the updateChart function with this selected option\n\n    changeMap(curr_nations, curr_games);\n  });\n  min_games = [20, 40, 60, 80, 100];\n  d3.select(\"#selectButton3\").selectAll('number').data(min_games).enter().append('option').text(function (d) {\n    return d;\n  }) // text showed in the menu\n  .attr(\"value\", function (d) {\n    return d;\n  }); // corresponding value returned by the button\n\n  d3.select(\"#selectButton3\").on(\"change\", function (d) {\n    // recover the option that has been chosen\n    var selectedOption = d3.select(this).property(\"value\"); // run the updateChart function with this selected option\n\n    curr_games = selectedOption;\n    changeMap(curr_nations, curr_games);\n  });\n  let filename_2 = \"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson\";\n  d3.json(filename_2).then(function (geoData) {\n    svg.append(\"g\").selectAll(\"path\").data(geoData.features).enter().append(\"path\").attr(\"fill\", \"#b8b8b8\").attr(\"d\", d3.geoPath().projection(projection)).style(\"stroke\", \"none\").style(\"opacity\", .3);\n  });\n  let title = svg.append(\"text\").attr(\"text-anchor\", \"end\").style(\"fill\", \"black\").attr(\"x\", (graph_3_width - margin.left) / 2).attr(\"y\", 20).attr(\"width\", 100).style(\"font-size\", 16).style(\"font-weight\", \"bold\");\n  var tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 0);\n\n  function changeMap(number, threshold) {\n    let filename_1 = FOOTBALL_DATA_SET;\n    let locations_file = \"latlong2.csv\";\n    d3.csv(filename_1).then(function (data) {\n      d3.csv(locations_file).then(function (locations) {\n        data = findWinPercentage(data, threshold);\n        data = data.sort(function (a, b) {\n          return b[1] - a[1];\n        }).slice(0, number);\n        locs = {};\n\n        for (var i = 0; i < locations.length; i++) {\n          let entry = locations[i];\n          locs[entry.Country] = [entry.Latitude, entry.Longitude];\n        }\n\n        let keys = Object.keys(location);\n\n        for (var i = 0; i < keys.length; i++) {\n          if (!(keys[i] in locs)) {\n            locs[keys[i]] = location[keys[i]];\n          }\n        }\n\n        for (var i = 0; i < data.length; i++) {\n          if (!(data[i][0] in locs)) {\n            console.log(data[i], locs[data[i][0]]);\n          }\n        } // let color = d3.scaleOrdinal()\n        // .range(d3.quantize(d3.interpolateHcl(\"#4062BB\", \"#81c2c3\"), places.length));\n\n\n        var value = d3.extent(data, d => d[1]);\n        var size = d3.scaleSqrt().domain(value).range([1, 30]);\n        let circles = svg.selectAll(\"circle\").data(data);\n        circles.enter().append(\"circle\").merge(circles).style(\"fill\", \"4062BB\").on(\"mouseover\", function (d) {\n          tooltip.transition().duration(100).style(\"opacity\", 0.9);\n          tooltip.html(\"<b>\" + d[0] + \"</b>\" + \"<br/>\" + \"<b>Wins</b>: \" + (d[1] * 100).toFixed(2) + \"%\").style(\"left\", d3.event.pageX + \"px\").style(\"top\", d3.event.pageY - 30 + \"px\");\n        }).on(\"mouseout\", function (d) {\n          tooltip.transition().duration(500).style(\"opacity\", 0);\n        }).transition().duration(1000).attr(\"cx\", function (d) {\n          return projection([locs[d[0]][1], locs[d[0]][0]])[0];\n        }).attr(\"cy\", function (d) {\n          return projection([locs[d[0]][1], locs[d[0]][0]])[1];\n        }).attr(\"r\", function (d) {\n          return size(+d[1]);\n        }).attr(\"fill-opacity\", .5); // .style(\"stroke\", \"black\")\n        // .style(\"stroke-width\", \"1px\")\n\n        title.html(`Top ${number} Winners`);\n        circles.exit().remove();\n      });\n    });\n\n    function findWinPercentage(data, threshold) {\n      var wins = {};\n      var games = {};\n      var win_pct = [];\n\n      for (var i = 0; i < data.length; i++) {\n        let home_team = data[i].home_team;\n        let away_team = data[i].away_team;\n        let score_dif = parseInt(data[i].home_score) - parseInt(data[i].away_score);\n        let winner = score_dif > 0 ? home_team : away_team;\n\n        if (!(winner in wins)) {\n          wins[winner] = 1;\n        } else {\n          wins[winner]++;\n        }\n\n        if (!(home_team in games)) {\n          games[home_team] = 1;\n        } else {\n          games[home_team]++;\n        }\n\n        if (!(away_team in games)) {\n          games[away_team] = 1;\n        } else {\n          games[away_team]++;\n        }\n      }\n\n      let keys = Object.keys(games);\n\n      for (var i = 0; i < keys.length; i++) {\n        if (keys[i] in wins && games[keys[i]] > threshold) {\n          win_pct.push([keys[i], wins[keys[i]] / games[keys[i]]]);\n        } else {\n          win_pct.push([keys[i], 0.0]);\n        }\n      }\n\n      return win_pct;\n    }\n  }\n\n  changeMap(10, 20);\n}\n\nfunction graph2() {\n  let svg = d3.select(\"#graph2\").append(\"svg\").attr(\"width\", graph_2_width).attr(\"height\", graph_2_height).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n  var tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip-2\").style(\"opacity\", 0);\n  d3.csv(FOOTBALL_DATA_SET).then(function (data) {\n    data = data.filter(function (entry) {\n      let year = parseInt(entry.date.slice(0, 4));\n      return entry.tournament == 'FIFA World Cup' && (year == 2018 || year == 2014);\n    });\n    winData = findWinPercentage(data);\n    goals = findGoals(data);\n\n    for (var i = 0; i < winData.length; i++) {\n      winData[i].push(goals[winData[i][0]]);\n    }\n\n    svg.append(\"text\").text(\"Win % vs Goals Scored by Teams for FIFA World Cups 2014 and 2018\").attr(\"transform\", `translate(${(graph_2_width - margin.left - margin.right) / 2}, ${-5})`).style(\"text-anchor\", \"middle\").style(\"font-size\", \"14\");\n    svg.append(\"text\").attr(\"transform\", `translate(${(graph_2_width - margin.left - margin.right) / 2},\n                                                ${graph_2_height - margin.top - margin.bottom + 40})`).style(\"text-anchor\", \"middle\").text(\"Goals\").attr(\"font-size\", \"14\");\n    svg.append(\"text\").attr(\"transform\", `translate(-50, ${(graph_1_height - margin.top - margin.bottom) / 2})`).style(\"text-anchor\", \"middle\").text(\"Win %\").attr(\"font-size\", \"14\");\n    let y = d3.scaleLinear().domain([0, d3.max(winData, d => d[1])]).range([graph_2_height - margin.top - margin.bottom, 0]);\n    let x = d3.scaleLinear().domain([0, d3.max(winData, d => d[2])]).range([0, graph_2_width - margin.left - margin.right]);\n    let h = graph_2_height - margin.top - margin.bottom;\n    svg.append(\"g\").attr(\"transform\", \"translate(0,\" + h + \")\").call(d3.axisBottom(x));\n    svg.append(\"g\").call(d3.axisLeft(y));\n    console.log(winData);\n    svg.append('g').selectAll(\"dot\").data(winData).enter().append(\"circle\").style(\"fill\", \"#F45B69\").on(\"mouseover\", function (d) {\n      tooltip.transition().duration(100).style(\"opacity\", 0.9);\n      tooltip.html(\"<b>\" + d[0] + \"</b>\" + \"<br/>\" + \"<b>Wins</b>: \" + d[1].toFixed(2) + \"%\" + \"<br/>\" + \"<b>Goals Scored</b>: \" + d[2]).style(\"left\", d3.event.pageX + \"px\").style(\"top\", d3.event.pageY - 30 + \"px\");\n    }).on(\"mouseout\", function (d) {\n      tooltip.transition().duration(500).style(\"opacity\", 0);\n    }).transition().duration(1000).attr(\"cx\", function (d) {\n      return x(d[2]);\n    }).attr(\"cy\", function (d) {\n      return y(d[1]);\n    }).attr(\"r\", 5);\n  });\n\n  function findWinPercentage(data) {\n    var wins = {};\n    var games = {};\n    var win_pct = [];\n\n    for (var i = 0; i < data.length; i++) {\n      let home_team = data[i].home_team;\n      let away_team = data[i].away_team;\n      let score_dif = parseInt(data[i].home_score) - parseInt(data[i].away_score);\n      let winner = score_dif > 0 ? home_team : away_team;\n\n      if (!(winner in wins)) {\n        wins[winner] = 1;\n      } else {\n        wins[winner]++;\n      }\n\n      if (!(home_team in games)) {\n        games[home_team] = 1;\n      } else {\n        games[home_team]++;\n      }\n\n      if (!(away_team in games)) {\n        games[away_team] = 1;\n      } else {\n        games[away_team]++;\n      }\n    }\n\n    let keys = Object.keys(games);\n\n    for (var i = 0; i < keys.length; i++) {\n      if (keys[i] in wins) {\n        win_pct.push([keys[i], wins[keys[i]] / games[keys[i]] * 100]);\n      } else {\n        win_pct.push([keys[i], 0.0]);\n      }\n    }\n\n    return win_pct;\n  }\n\n  function findGoals(data) {\n    var goals = {};\n\n    for (var i = 0; i < data.length; i++) {\n      let home_team = data[i].home_team;\n      let away_team = data[i].away_team;\n      let home_score = parseInt(data[i].home_score);\n      let away_score = parseInt(data[i].away_score);\n\n      if (!(home_team in goals)) {\n        goals[home_team] = home_score;\n      } else {\n        goals[home_team] = goals[home_team] + home_score;\n      }\n\n      if (!(away_team in goals)) {\n        goals[away_team] = away_score;\n      } else {\n        goals[away_team] = goals[away_team] + away_score;\n      }\n    }\n\n    return goals;\n  }\n}\n\nexport default function main() {\n  graph1();\n  graph3();\n  graph2();\n}","map":{"version":3,"sources":["/Users/rudrasrivastava/Desktop/personal_website/src/main.js"],"names":["MAX_WIDTH","Math","max","window","innerWidth","MAX_HEIGHT","margin","top","right","bottom","left","graph_1_width","graph_1_height","graph_2_width","graph_2_height","graph_3_width","graph_3_height","FOOTBALL_DATA_SET","graph1","svg","d3","select","append","attr","h","countG","y_axis_label","title","text","style","groups","selectAll","data","enter","d","on","selectedOption","property","filterData","option","filename","csv","then","getData","entry","dif","parseInt","date","slice","countGamesInYear","sortData","a","b","y","scaleLinear","domain","range","x","scaleBand","map","padding","call","axisBottom","tickPadding","bars","merge","transition","duration","bandwidth","counts","exit","remove","comparator","filter","new_data","Object","keys","sort","key","countData","i","length","year","graph3","location","projection","geoMercator","center","scale","translate","curr_nations","curr_games","changeMap","min_games","filename_2","json","geoData","features","geoPath","tooltip","number","threshold","filename_1","locations_file","locations","findWinPercentage","locs","Country","Latitude","Longitude","console","log","value","extent","size","scaleSqrt","circles","html","toFixed","event","pageX","pageY","wins","games","win_pct","home_team","away_team","score_dif","home_score","away_score","winner","push","graph2","tournament","winData","goals","findGoals","axisLeft","main"],"mappings":"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","sourcesContent":["// Add your JavaScript code here\nconst MAX_WIDTH = Math.max(1080, window.innerWidth);\nconst MAX_HEIGHT = 720;\nconst margin = {top: 40, right: 100, bottom: 40, left: 175};\n\n// Assumes the same graph width, height dimensions as the example dashboard. Feel free to change these if you'd like\nlet graph_1_width = (MAX_WIDTH / 2) - 10, graph_1_height = 250;\nlet graph_2_width = (MAX_WIDTH / 2) - 10, graph_2_height = 275;\nlet graph_3_width = MAX_WIDTH / 2, graph_3_height = 575;\n\nFOOTBALL_DATA_SET = \"/football.csv\"\n\n\nfunction graph1(){\n\n    let svg = d3.select(\"#graph1\")\n        .append(\"svg\")\n        .attr(\"width\", graph_1_width)    \n        .attr(\"height\", graph_1_height)     \n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n    let h = graph_1_height - margin.top - margin.bottom\n\n    let countG = svg.append(\"g\")\n    var y_axis_label = svg.append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + h + \")\")\n\n    let title = svg.append(\"text\").text(\"Number of Games Played by Year\")\n            .attr(\"transform\", `translate(${(graph_1_width - margin.left - margin.right) / 2}, ${-25})`)       \n            .style(\"text-anchor\", \"middle\")\n            .style(\"font-size\", \"14\");\n\n    svg.append(\"text\")\n            .attr(\"transform\", `translate(${(graph_1_width - margin.left - margin.right) / 2},\n                                                ${(graph_1_height - margin.top - margin.bottom) + 40})`)       \n            .style(\"text-anchor\", \"middle\")\n            .text(\"Year\").attr(\"font-size\", \"14\");    \n            \n\n    svg.append(\"text\")\n            .attr(\"transform\", `translate(-50, ${(graph_1_height - margin.top - margin.bottom) / 2})`)       \n            .style(\"text-anchor\", \"middle\").text(\"Count\").attr(\"font-size\", \"14\");    \n\n    \n    groups = [2020, 2010, 2000, 1990, 1980, 1970, 1960, 1950, 1940, 1930, 1920, 1910, 1900];\n    d3.select(\"#selectButton\")\n    .selectAll('year').data(groups)\n      .enter()\n        .append('option')\n      .text(function (d) { return d; }) \n      .attr(\"value\", function (d) { return d; }) \n\n    d3.select(\"#selectButton\").on(\"change\", function(d) {\n        var selectedOption = d3.select(this).property(\"value\")\n        filterData(selectedOption)\n    })\n\n    function filterData(option){\n\n        let filename = FOOTBALL_DATA_SET;\n        d3.csv(filename).then(function(data) {\n\n            \n            data = getData(data, function(entry){\n                    let dif = option - parseInt(entry.date.slice(0,4))\n                    if(dif >= 0 && dif < 10){\n                        return true;\n                    }\n                    return false;\n            });\n            \n            \n            data = countGamesInYear(data)\n            data = sortData(data, function(a , b){\n                return b - a\n            });\n            \n\n            let y = d3.scaleLinear()\n                .domain([0, d3.max(data, d => d[1])])\n                .range([graph_1_height - margin.top - margin.bottom, 0]);\n\n            let x = d3.scaleBand()\n                .domain(data.map(d => d[0]))\n                .range([0, graph_1_width - margin.left - margin.right])\n                .padding(0.1);\n            \n            \n            y_axis_label.call(d3.axisBottom(x).tickPadding(5))\n\n            \n            // let color = d3.scaleOrdinal()\n            //     .range(d3.schemeAccent);\n\n            let bars = svg.selectAll(\"rect\").data(data);\n\n            bars.enter()\n                .append(\"rect\")\n                .merge(bars).transition()\n                .duration(1000)\n                .attr(\"fill\", \"#59C3C3\")    \n                .attr(\"x\", function(d) { return x(d[0]); })\n                .attr(\"y\", d => y(d[1]))         \n                .attr(\"width\", x.bandwidth())\n                .attr(\"height\",  function(d) { return graph_1_height - margin.top - margin.bottom- y(d[1]); }); \n            \n            let counts = countG.selectAll(\"text\").data(data);\n\n            counts.enter()\n                    .append(\"text\")\n                    .merge(counts)\n                    .transition()\n                    .duration(1000)\n                    .attr(\"y\", function(d) { return y(d[1]) - 5; })       \n                    .attr(\"x\", function(d) { return x(d[0]) + 0.35*x.bandwidth(); })       \n                    .style(\"text-anchor\", \"start\")\n                    .text(function(d) {return d[1];})  \n                    .attr(\"font-size\", \"12\");    \n        \n            \n            \n            bars.exit().remove();\n            counts.exit().remove();\n\n\n            function getData(data, comparator) {\n                return data.filter(comparator);\n            }\n\n            function sortData(data, comparator){\n                let new_data = Object.keys(data)\n                return new_data.sort(comparator).slice(0, 10).map(key => [key, data[key]]);\n            }\n\n            function countGamesInYear(data){\n                var countData = {}\n\n                for(var i = 0; i < data.length; i++){\n                    let year = parseInt(data[i].date.slice(0,4))\n                    if(!(year in countData)){\n                        countData[year] = 1;\n                    }\n                    else{\n                        countData[year] ++;\n                    }\n\n                }\n\n                return countData\n            }\n\n        });    \n    }\n\n    filterData(2020)\n}\n\n\nfunction graph3(){\n\n    var location = {\"Asturias\": [43.36, -5.95],\n                    \"Jersey\": [49.21, -2.13],\n                    \"Chameria\": [46.46, 5.56],\n                    \"Menorca\": [39.94, 4.11],\n                    \"Canary Islands\": [28.29, -16.62],\n                    \"Padania\": [45.29, 11.16],\n                    \"Basque Country\": [42.96, -2.59],\n                    \"Brazil\": [-23.53, -46.62],\n                    \"Tahiti\": [-17.36, -149.5],\n                    \"Ivory Coast\": [5.34, -4.02],\n                    \"Iraqi Kurdistan\": [30.86, 44.10],\n                    \"Ynys MÃ´n\":[53.267684, -4.371611],\n                    \"Isle of Man\": [54.205801, -4.529593],\n                    \"Abkhazia\": [43.141859, 40.999746],\n                    \"Guernsey\": [49.446756, -2.573537],\n                    \"Yugoslavia\": [44.810045, 20.429455],\n                    \"Isle of Wight\": [50.682774, -1.318987],\n                    \"Scotland\": [57.087281, -2.908522],\n                    \"China PR\": [32.137429, 103.543756],\n                    \"German DR\": [52.555621, 13.382851]\n                    }\n\n    let svg = d3.select(\"#graph3\")\n        .append(\"svg\")\n        .attr(\"width\", graph_3_width)    \n        .attr(\"height\", graph_3_height)     \n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n    var projection = d3.geoMercator()\n        .center([0,20])                // GPS of location to zoom on\n        .scale(99)                       // This is like the zoom\n        .translate([(graph_3_width-margin.left-margin.right)/2, (graph_3_height-margin.top-margin.bottom)/2 ])\n\n    \n    var curr_nations = 10;\n    var curr_games = 20;\n\n    groups = [10, 20, 30, 40];\n    d3.select(\"#selectButton2\")\n    .selectAll('number').data(groups)\n      .enter()\n        .append('option')\n      .text(function (d) { return d; }) // text showed in the menu\n      .attr(\"value\", function (d) { return d; }) // corresponding value returned by the button\n\n    d3.select(\"#selectButton2\").on(\"change\", function(d) {\n        // recover the option that has been chosen\n        var selectedOption = d3.select(this).property(\"value\")\n        curr_nations = selectedOption;\n        // run the updateChart function with this selected option\n        changeMap(curr_nations, curr_games)\n    })\n\n    min_games = [20, 40, 60, 80, 100];\n    d3.select(\"#selectButton3\")\n    .selectAll('number').data(min_games)\n      .enter()\n        .append('option')\n      .text(function (d) { return d; }) // text showed in the menu\n      .attr(\"value\", function (d) { return d; }) // corresponding value returned by the button\n\n    d3.select(\"#selectButton3\").on(\"change\", function(d) {\n        // recover the option that has been chosen\n        var selectedOption = d3.select(this).property(\"value\")\n        // run the updateChart function with this selected option\n        curr_games = selectedOption;\n        changeMap(curr_nations, curr_games)\n    })\n\n    let filename_2 = \"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson\";\n\n    d3.json(filename_2).then(function(geoData) {\n\n        svg.append(\"g\")\n                    .selectAll(\"path\")\n                    .data(geoData.features)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"fill\", \"#b8b8b8\")\n                    .attr(\"d\", d3.geoPath()\n                        .projection(projection)\n                    )\n                    .style(\"stroke\", \"none\")\n                    .style(\"opacity\", .3)\n\n    });\n\n    let title = svg\n    .append(\"text\")\n    .attr(\"text-anchor\", \"end\")\n    .style(\"fill\", \"black\")\n    .attr(\"x\", (graph_3_width - margin.left)/2)\n    .attr(\"y\", 20)\n    .attr(\"width\", 100).style(\"font-size\", 16)\n    .style(\"font-weight\", \"bold\")\n\n    var tooltip = d3.select(\"body\").append(\"div\")\t\n                    .attr(\"class\", \"tooltip\")\t\t\t\t\n                    .style(\"opacity\", 0);\n    \n    function changeMap(number, threshold){\n\n    \n\n        let filename_1 = FOOTBALL_DATA_SET;\n        let locations_file = \"latlong2.csv\"\n        d3.csv(filename_1).then(function(data) {\n            \n                d3.csv(locations_file).then(function(locations) {\n\n                    data = findWinPercentage(data, threshold);\n                    data = data.sort(function(a, b){\n                        return b[1] - a[1]\n                    }).slice(0, number);\n\n                    locs = {}\n\n                    for(var i = 0; i < locations.length; i++){\n                        let entry = locations[i];\n                        locs[entry.Country] = [entry.Latitude, entry.Longitude];\n                    }\n                    \n                    let keys = Object.keys(location);\n                    for(var i = 0; i < keys.length; i++){\n                        if(!(keys[i] in locs)){\n                            locs[keys[i]] = location[keys[i]];\n                        }\n                    \n                    }\n\n                    for(var i = 0; i < data.length; i++){\n                        if(!(data[i][0] in locs)){\n                            console.log(data[i], locs[data[i][0]])\n                        }\n                    }\n\n                    // let color = d3.scaleOrdinal()\n                    // .range(d3.quantize(d3.interpolateHcl(\"#4062BB\", \"#81c2c3\"), places.length));\n\n                    var value = d3.extent(data, d=> d[1])\n                    var size = d3.scaleSqrt()\n                    .domain(value)  \n                    .range([1, 30]) \n\n                    let circles = svg\n                    .selectAll(\"circle\").data(data)\n\n                    \n                    circles.enter()\n                    .append(\"circle\")\n                    .merge(circles)\n                    .style(\"fill\", \"4062BB\").on(\"mouseover\", function(d) {\t\t\n                        tooltip.transition()\t\t\n                            .duration(100)\t\t\n                            .style(\"opacity\", 0.9);\t\n                        \t\n                        tooltip.html(\"<b>\"+d[0]+ \"</b>\" + \"<br/>\"  + \"<b>Wins</b>: \" + (d[1]*100).toFixed(2) + \"%\")\t\n                            .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                            .style(\"top\", (d3.event.pageY - 30) + \"px\");\t\n                        })\t\t\t\t\t\n                    .on(\"mouseout\", function(d) {\t\t\n                        tooltip.transition()\t\t\n                            .duration(500)\t\t\n                            .style(\"opacity\", 0);\n                    })\t\n                    .transition()\n                    .duration(1000)\n                    .attr(\"cx\", function(d){ return projection([locs[d[0]][1], locs[d[0]][0]])[0] })\n                    .attr(\"cy\", function(d){ return projection([locs[d[0]][1], locs[d[0]][0]])[1] })\n                    .attr(\"r\", function(d){ return size(+d[1]) })\n                    .attr(\"fill-opacity\", .5);\n                    // .style(\"stroke\", \"black\")\n                    // .style(\"stroke-width\", \"1px\")\n                    \n                    title.html(`Top ${number} Winners`)\n                    \n                    circles.exit().remove()\n                });\n            \n        });\n\n        function findWinPercentage(data, threshold){\n            var wins = {}\n            var games = {}\n            var win_pct = []\n\n            for(var i = 0; i < data.length; i++){\n                let home_team = data[i].home_team;\n                let away_team = data[i].away_team;\n                let score_dif = parseInt(data[i].home_score) - parseInt(data[i].away_score);\n                let winner = score_dif > 0 ? home_team : away_team;\n\n                \n                if(!(winner in wins)){\n                    wins[winner] = 1;\n                }\n                else{\n                    wins[winner] ++;\n                }\n                \n\n                if(!(home_team in games)){\n                    games[home_team] = 1;\n                }\n                else{\n                    games[home_team] ++;\n                }\n\n                if(!(away_team in games)){\n                    games[away_team] = 1;\n                }\n                else{\n                    games[away_team] ++;\n                }\n            }\n            let keys = Object.keys(games)\n            for(var i = 0; i < keys.length; i++){\n                if(keys[i] in wins && games[keys[i]] > threshold){\n                    win_pct.push([keys[i], (wins[keys[i]]/games[keys[i]])])\n                }\n                else{\n                    win_pct.push([keys[i], 0.0])\n                }\n\n            }\n\n            return win_pct\n        }\n    }\n\n    changeMap(10, 20);\n\n\n}\n\nfunction graph2(){\n\n    let svg = d3.select(\"#graph2\")\n        .append(\"svg\")\n        .attr(\"width\", graph_2_width)    \n        .attr(\"height\", graph_2_height)     \n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n\n    var tooltip = d3.select(\"body\").append(\"div\")\t\n        .attr(\"class\", \"tooltip-2\")\t\t\t\t\n        .style(\"opacity\", 0);\n\n    d3.csv(FOOTBALL_DATA_SET).then(function(data) {\n\n\n        data = data.filter(function(entry){\n            let year = parseInt(entry.date.slice(0, 4))\n            return (entry.tournament == 'FIFA World Cup') && (year == 2018 || year == 2014)\n        });\n\n        winData = findWinPercentage(data)\n        goals = findGoals(data)\n    \n        for(var i = 0; i <winData.length; i++){\n\n            winData[i].push(goals[winData[i][0]])\n        }\n\n        svg.append(\"text\").text(\"Win % vs Goals Scored by Teams for FIFA World Cups 2014 and 2018\")\n            .attr(\"transform\", `translate(${(graph_2_width - margin.left - margin.right) / 2}, ${-5})`)       \n            .style(\"text-anchor\", \"middle\")\n            .style(\"font-size\", \"14\");\n\n        svg.append(\"text\")\n            .attr(\"transform\", `translate(${(graph_2_width - margin.left - margin.right) / 2},\n                                                ${(graph_2_height - margin.top - margin.bottom) + 40})`)       \n            .style(\"text-anchor\", \"middle\")\n            .text(\"Goals\").attr(\"font-size\", \"14\");    \n            \n\n        svg.append(\"text\")\n            .attr(\"transform\", `translate(-50, ${(graph_1_height - margin.top - margin.bottom) / 2})`)       \n            .style(\"text-anchor\", \"middle\").text(\"Win %\").attr(\"font-size\", \"14\");    \n\n        let y = d3.scaleLinear()\n            .domain([0, d3.max(winData, d => d[1])])\n            .range([graph_2_height - margin.top - margin.bottom, 0]);\n\n        let x = d3.scaleLinear()\n        .domain([0, d3.max(winData, d => d[2])])\n        .range([0, graph_2_width - margin.left - margin.right]);\n        \n        let h = graph_2_height - margin.top - margin.bottom\n        svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + h + \")\")\n        .call(d3.axisBottom(x));\n\n        svg.append(\"g\")\n        .call(d3.axisLeft(y));\n\n        console.log(winData)\n\n        svg.append('g')\n        .selectAll(\"dot\")\n        .data(winData)\n        .enter()\n        .append(\"circle\")\n        .style(\"fill\", \"#F45B69\")\n        .on(\"mouseover\", function(d) {\t\t\n            tooltip.transition()\t\t\n                .duration(100)\t\t\n                .style(\"opacity\", 0.9);\t\n                \n            tooltip.html(\"<b>\"+d[0]+ \"</b>\" + \"<br/>\"  + \"<b>Wins</b>: \" + d[1].toFixed(2) + \"%\" + \"<br/>\"  + \"<b>Goals Scored</b>: \" + d[2])\t\n                .style(\"left\", (d3.event.pageX) + \"px\")\t\t\n                .style(\"top\", (d3.event.pageY - 30) + \"px\");\t\n            })\t\t\t\t\t\n        .on(\"mouseout\", function(d) {\t\t\n            tooltip.transition()\t\t\n                .duration(500)\t\t\n                .style(\"opacity\", 0);\n        })\t\n        .transition()\n        .duration(1000)\n        .attr(\"cx\", function (d) { return x(d[2]); } )\n        .attr(\"cy\", function (d) { return y(d[1]); } )\n        .attr(\"r\", 5)\n        \n\n\n    });\n        \n\n    function findWinPercentage(data){\n            var wins = {}\n            var games = {}\n            var win_pct = []\n\n            for(var i = 0; i < data.length; i++){\n                let home_team = data[i].home_team;\n                let away_team = data[i].away_team;\n                let score_dif = parseInt(data[i].home_score) - parseInt(data[i].away_score);\n                let winner = score_dif > 0 ? home_team : away_team;\n\n                \n                if(!(winner in wins)){\n                    wins[winner] = 1;\n                }\n                else{\n                    wins[winner] ++;\n                }\n                \n\n                if(!(home_team in games)){\n                    games[home_team] = 1;\n                }\n                else{\n                    games[home_team] ++;\n                }\n\n                if(!(away_team in games)){\n                    games[away_team] = 1;\n                }\n                else{\n                    games[away_team] ++;\n                }\n            }\n            let keys = Object.keys(games)\n            for(var i = 0; i < keys.length; i++){\n                if(keys[i] in wins){\n                    win_pct.push([keys[i], ((wins[keys[i]]/games[keys[i]])*100)])\n                }\n                else{\n                    win_pct.push([keys[i], 0.0])\n                }\n\n            }\n\n            return win_pct\n    }\n\n    function findGoals(data){\n\n            var goals = {}\n            for(var i = 0; i < data.length; i++){\n                let home_team = data[i].home_team;\n                let away_team = data[i].away_team;\n                let home_score = parseInt(data[i].home_score);\n                let away_score = parseInt(data[i].away_score);\n\n                if(!(home_team in goals)){\n                    goals[home_team] = home_score;\n                }\n                else{\n                    goals[home_team] = goals[home_team] + home_score;\n                }\n\n                if(!(away_team in goals)){\n                    goals[away_team] = away_score;\n                }\n                else{\n                    goals[away_team] = goals[away_team] + away_score;\n                }\n        \n            }\n            return goals\n    }\n}\n\nexport default function main(){\n    graph1();\n    graph3();\n    graph2();\n}\n\n\n"]},"metadata":{},"sourceType":"module"}